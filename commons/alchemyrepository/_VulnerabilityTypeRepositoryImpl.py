from sqlalchemy.orm import Session

from domain.models import VulnerabilityType
from domain.repository import VulnerabilityTypeRepository as definition

class VulnerabilityTypeRepository(definition):
	def __init__(self,
				 session: Session):
		self.session = session

	def get_by_id(self,
				  vulnerability_type_id: int) -> VulnerabilityType:
		return self.session.query(VulnerabilityType).filter(VulnerabilityType.id == vulnerability_type_id).first()

	def get_by_name(self,
					name: str) -> VulnerabilityType:
		return self.session.query(VulnerabilityType).filter(VulnerabilityType.name == name).first()

	def add(self,
			vulnerability_type: VulnerabilityType) -> VulnerabilityType:
		self.session.add(vulnerability_type)
		self.session.flush()
		return vulnerability_type
	
	def update(self,
			   vulnerability_type: VulnerabilityType) -> VulnerabilityType:
		self.session.flush()
		return vulnerability
