from datetime import datetime
from typing import Optional

from ._Host import Host
from ._Machine import Machine
from ._Path import Path
from ._VulnerabilityStatusEnum import VulnerabilityStatusEnum
from ._VulnerabilityType import VulnerabilityType

class Vulnerability(object):
	def __init__(self,
				 type: VulnerabilityType,
				 status: VulnerabilityStatusEnum,
				 found_by: str,
				 found_dttm: Optional[datetime] = datetime.now(),
				 confirmed_by: Optional[str] = None,
				 confirmed_dttm: Optional[datetime] = None,
				 solved_dttm: Optional[datetime] = None,
				 host: Optional[Host] = None,
				 path: Optional[Path] = None,
				 machine: Optional[Machine] = None,
				 updated_dttm: Optional[datetime] = datetime.now()
	):
		self.id = None
		self.type = type
		self.status = status
		self.found_by = found_by
		self.found_dttm = found_dttm
		self.confirmed_by = confirmed_by
		self.confirmed_dttm = confirmed_dttm
		self.solved_dttm = solved_dttm
		self.host = host
		self.path = path
		self.machine = machine
		self.updated_dttm = updated_dttm

	def __repr__(self):
		return self.__str__()

	def __str__(self):
		return str(self.__dict__)
